# Задача 4.2: Реализация прогресса пользователя

## Подготовка

Перед началом выполнения задачи, пожалуйста, ознакомьтесь с следующими документами для восстановления контекста:
- [Концепция проекта](../docs/bizlevel-concept.md)
- [План разработки](../docs/development-plan.md)
- [Текущий статус проекта](../docs/status.md)

## Описание задачи

Необходимо реализовать систему отслеживания и отображения прогресса пользователя в приложении BizLevel. Прогресс должен отражать взаимодействие пользователя с образовательным контентом, включая прохождение уровней, просмотр видео и скачивание артефактов.

### Шаги выполнения:

1. **Создание сервиса progressService для работы с прогрессом:**
   - Разработать сервис для взаимодействия с таблицами прогресса в Supabase
   - Реализовать методы для получения прогресса пользователя по уровням
   - Добавить методы для обновления прогресса (начало/завершение уровня)
   - Настроить работу с подписками на изменения прогресса через Supabase Realtime

2. **Интеграция данных прогресса с отображением на карте:**
   - Интегрировать progressService с компонентом LevelMap
   - Реализовать визуализацию прогресса на карточках уровней
   - Добавить общий индикатор прогресса по всем уровням
   - Обеспечить динамическое обновление отображения при изменении прогресса

3. **Создание тестовых данных для уровней и прогресса:**
   - Подготовить набор тестовых уровней в базе данных
   - Создать записи о прогрессе для тестовых пользователей
   - Настроить различные сценарии прогресса для тестирования
   - Добавить скрипт или инструкцию для быстрого создания тестовых данных

4. **Реализация базовой страницы уровня (/level/[levelId]):**
   - Создать компонент страницы уровня с динамическим маршрутом
   - Настроить получение данных уровня по его ID
   - Добавить отображение прогресса пользователя по этому уровню
   - Реализовать заглушки для компонентов видео, тестов и артефактов

## Состояния прогресса

Для корректного отображения прогресса необходимо реализовать следующие состояния:
- **Не начат** - пользователь еще не взаимодействовал с уровнем
- **В процессе** - пользователь начал, но не завершил уровень
- **Завершен** - пользователь полностью завершил уровень
- **Заблокирован** - уровень недоступен для пользователя (зависит от прогресса или оплаты)

## Отслеживаемые метрики прогресса

Прогресс пользователя должен учитывать:
- Процент просмотренных видео в уровне
- Прохождение тестов по видео
- Скачивание артефактов
- Общее завершение уровня

## Проверка работы

Для проверки корректности реализации прогресса выполните:
- Тестирование отображения прогресса для разных пользователей
- Изменение прогресса и проверка обновления отображения
- Тестирование навигации между картой и страницей уровня с сохранением контекста прогресса
- Проверка корректности вычисления общего прогресса

## Ожидаемый результат

- Функциональный сервис для работы с прогрессом пользователя
- Корректное отображение прогресса на карте уровней
- Базовая страница уровня с отображением прогресса
- Набор тестовых данных для демонстрации различных сценариев

## Дополнительные материалы

- [Supabase Realtime для обновления прогресса](https://supabase.com/docs/guides/realtime)
- [Patterns для отображения прогресса в UI](https://www.smashingmagazine.com/2016/07/creative-progress-indicators/)
- [Next.js Dynamic Routes](https://nextjs.org/docs/app/building-your-application/routing/dynamic-routes)
- [Zustand для глобального состояния](https://github.com/pmndrs/zustand)

## После выполнения

После завершения задачи не забудьте обновить файл [status.md](../docs/status.md) с информацией о реализованной системе отслеживания прогресса, созданных компонентах и любых возникших проблемах при работе с Supabase Realtime. 