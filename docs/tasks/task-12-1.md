# Задача 12.1: Создание базовой админ-панели

## Подготовка
Перед началом работы ознакомьтесь с документами, чтобы восстановить контекст проекта:
- [Статус проекта](../docs/status.md)
- [План разработки](../docs/development-plan.md)
- [Концепция проекта](../docs/bizlevel-concept.md)

## Описание задачи
После успешного завершения основного функционала приложения BizLevel, необходимо создать базовую административную панель, которая позволит управлять контентом платформы, пользователями и ресурсами. Админ-панель должна быть доступна только пользователям с административными правами и предоставлять удобный интерфейс для управления платформой.

### Основные требования:
1. Создание защищенного маршрута /admin:
   - Разработка структуры маршрутов админ-панели (/admin, /admin/levels, /admin/users и т.д.)
   - Настройка middleware для проверки административных прав при доступе к маршрутам /admin/*
   - Создание механизма редиректа неавторизованных пользователей
   - Добавление в базу данных поля для идентификации администраторов (is_admin в таблице profiles)
   - Разработка страницы доступа запрещен (403) для неавторизованных попыток доступа

2. Реализация проверки административных прав:
   - Создание сервиса для проверки прав пользователя
   - Настройка защиты API-эндпоинтов, используемых в административной панели
   - Использование Supabase RLS-политик для ограничения доступа к административным функциям
   - Создание хука useAdmin для проверки административных прав на стороне клиента
   - Обеспечение защиты от уязвимостей типа insecure direct object reference (IDOR)

3. Создание базового макета и навигации админ-панели:
   - Разработка компонента AdminLayout для страниц административной панели
   - Создание AdminSidebar с навигацией по разделам админ-панели
   - Реализация компонента AdminHeader с информацией о текущем пользователе и системе
   - Дизайн в соответствии с общим стилем приложения, но с явным отличием от пользовательского интерфейса
   - Адаптивная верстка для удобства использования на различных устройствах

4. Реализация базовой статистики и обзора:
   - Создание дашборда с основными метриками (количество пользователей, уровней, продаж)
   - Реализация графиков и визуализации данных для ключевых показателей
   - Добавление списков последних регистраций, платежей и активностей
   - Создание карточек с суммарной информацией о состоянии платформы
   - Реализация фильтров и настройки отображения статистики

## Технические детали
- Используйте компоненты shadcn/ui для создания интерфейса админ-панели
- Для визуализации данных можно использовать библиотеки recharts или chart.js
- Применяйте Server Components Next.js для начальной загрузки данных
- Убедитесь, что все административные функции хорошо защищены на уровне API и базы данных
- Для улучшения UX используйте оптимистичные обновления интерфейса

## Проверки и тестирование
- Протестируйте доступ к админ-панели с разными типами учетных записей
- Убедитесь, что пользователь без прав администратора не может получить доступ к защищенным маршрутам
- Проверьте корректность отображения статистики и данных в дашборде
- Протестируйте навигацию между различными разделами админ-панели
- Убедитесь, что интерфейс корректно работает на различных устройствах

## Завершение задачи
После выполнения задачи:
1. Обновите файл [status.md](../docs/status.md) с подробным описанием реализованной функциональности
2. Убедитесь, что все компоненты админ-панели соответствуют общему стилю проекта
3. Проверьте безопасность и защиту административных функций
4. Составьте список рекомендаций по дальнейшему развитию админ-панели 